
# Как запустить

## То с чем точно работает
go 1.17.3
mongodb 4.4.4
Linux Fedora 33

## Mongo
1. Добавить соответствующий репозиторий. Например не Федоре, это:
```
cd /etc/yum.repos.d
touch mongodb-org-4.4.repo
```
2. В файл `mongodb-org-4.4.repo` записать: 
```
[mongodb-org-4.4]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/8/mongodb-org/4.4/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-4.4.asc
```
`sudo dnf install mongodb-org`

3. Запустить сервер БД
`sudo mongod`

4. Проверить, что всё работает
`mongosh` -- Должна открыться оболочка командной строки

5. Альтернативно можно зарегистрироваться на сайте mongodb.com (нужен ВПН) и воспользоваться пробной версией
их сервиса Atlas. Тогда перед использованием программы нужно будет подправить конфиг.

## Go
Смотри https://go.dev/doc/install

## Запуск
Клонируем репозиторий и переходим в папку с кодом.
```
git clone https://github.com/telephrag/bscrap
cd bscrap
``` 

Также можно просто скачать этот репозиторий, на этой странице.

Если вы создали пробную БД с помощью Atlas, то нужно в личном кабинете скопировать URI и заменить им значение константы 
`DBUri` в файле `bscrap/config/db.go`.

Скачиваем зависимости и запускаем
```
go mod vendor
go run main.go
``` 

Через мгновение после запуска программа временно остановится. В другом окне открываем оболочку Монго. 
Переключаемся на используемую программой БД и выводит все документы используемой программой коллекции
```
mongosh
use bscrapdb
db.bscrap.find()
```

В окне терминала с программой нажимаем `Ctrl+C`. Программа продолжит работу, а только что добавленная запись будет удалена из БД. В этом можно убедиться повторно прописав `db.bscrap.find()` в оболочке Монго.

Повторно нажимаем `Ctrl+C`, чтобы завершить работу программы.
